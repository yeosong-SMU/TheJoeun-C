<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ko">
<head>
<meta charset="UTF-8">
<title>상품 목록</title>
</head>
<body>
<h2>상품 목록</h2>
<table border="1">
<thead>
	<tr>
		<th>ID</th>
		<th>이름</th>
		<th>재고</th>
		<th>임계치</th>
		<th>재고수정</th>
	</tr>
</thead>
<tbody>
	<tr th:each="p : ${items}">
		<td th:text="${p.id}"></td>
		<td th:text="${p.name}"></td>
		<td th:text="${p.stockQty}"></td>
		<td th:text="${p.safetyStock}"></td>
		<td>
			<input type="number" min="0" th:attr="id=${'qty-'+p.id}" />
			<button th:attr="onclick=|updateStock(${p.id})|">저장</button>
		</td>
	</tr>
</tbody>
</table>

<script>
async function updateStock(id) {
	const qty = document.getElementById('qty-' + id).value || 0;
	const res = await
	fetch(`/stock/${id}?qty=` + qty, {
		method: 'POST'
	});
	if (!res.ok) {
		alert('실패');
		return;
	}
	alert('수정되었습니다.');
	location.reload();
}
</script>
</body>
</html>